<!DOCTYPE html>
<html lang="en" data-theme="light">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>Recipe Keeper</title>
  <meta name="theme-color" content="#ffffff" />
  <link rel="stylesheet" href="style.css" />
  <script src="https://apis.google.com/js/api.js" defer></script>
</head>

<body>

<!-- Password Lock (local-only) -->
<div id="lock" class="lock hidden">
  <div class="lock-box">
    <h3 id="lockTitle">Unlock Recipe Keeper</h3>
    <p class="muted small" id="lockHint">This protects only this device. Recipes live in your Google Drive.</p>
    <input id="lockInput" type="password" placeholder="Enter password" />
    <div class="actions">
      <button id="unlockBtn" class="btn primary">Unlock</button>
      <button id="setPassBtn" class="btn">Set/Change password</button>
    </div>
    <div id="lockMsg" class="muted small"></div>
  </div>
</div>

<!-- Main App -->
<div id="app" class="hidden">

  <h1>Recipe Keeper</h1>

  <input id="search" placeholder="Search title, ingredients, note">

  <button id="newBtn" class="btn primary small">+ New</button>
  <label><input type="checkbox" id="offlineChk"> Offline</label>
  <label><input type="checkbox" id="themeChk"> Dark</label>

  <h3>Google Drive setup</h3>
  <label>CLIENT_ID <input id="clientId" placeholder="your OAuth client id"></label>
  <label>API_KEY <input id="apiKey" placeholder="your API key"></label>

  <button id="connectBtn" class="btn small">Connect</button>
  <button id="signOutBtn" class="btn small">Sign out</button>

  <p class="muted small">
    Add your site URL to OAuth “Authorized JavaScript origins”.
  </p>

  <pre>
/RecipeKeeper/
  ├─ recipes.json
  └─ images/
  </pre>

  <p class="muted small">
    Sync runs at Save and on app start.
  </p>

  <button id="catBtn" class="btn small">Manage categories</button>
  <button id="settingsBtn" class="btn small">Settings</button>
  <button id="exportBtn" class="btn small">Export</button>
  <label class="btn small">Import <input type="file" id="importFile" hidden></label>

  <p class="muted small">Private: cached locally + synced to your Google Drive.</p>

  <h2>New recipe</h2>
  <div id="editor"></div>
</div>

<!-- Dialogs -->
<dialog id="settingsDlg">
  <div class="dlg-h">Settings</div>
  <div class="dlg-b">
    <div class="muted small">Password (local-only)</div>
    <label>New password</label>
    <input id="newPass" type="password">
    <div class="actions">
      <button id="savePassBtn" class="btn primary small">Save</button>
      <button id="closeSettings" class="btn small">Close</button>
    </div>
    <div id="settingsMsg" class="muted small"></div>
  </div>
</dialog>

<!-- SCRIPTS (fixed order + defer) -->
<script src="password.js" defer></script>
<script src="drive.js" defer></script>
<script src="app.js" defer></script>

<!-- Global error logger -->
<script>
window.onerror = (msg, src, line, col, err) => {
  alert("JS Error: " + msg + "\n" + src + ":" + line);
};
</script>

</body>
</html>
